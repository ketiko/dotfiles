#!/usr/bin/env bash

set -e

echo "Processing asdf"

if [ ! -d ~/.asdf ]; then
  echo "Installing adsf"
  git clone https://github.com/asdf-vm/asdf.git ~/.asdf
  cd ~/.asdf || return
  git checkout "$(git describe --abbrev=0 --tags)"

fi

. ~/.asdf/asdf.sh
. ~/.asdf/completions/asdf.bash

asdf plugin add golang                       https://github.com/kennyp/asdf-golang.git
asdf plugin add helm                         https://github.com/Antiarchitect/asdf-helm.git
asdf plugin add java                         https://github.com/halcyon/asdf-java.git
asdf plugin add krew                         https://github.com/bjw-s/asdf-krew
asdf plugin add kubecolor                    https://github.com/dex4er/asdf-kubecolor.git
asdf plugin add kubectl                      https://github.com/asdf-community/asdf-kubectl.git
asdf plugin add kubectx                      https://gitlab.com/wt0f/asdf-kubectx.git
asdf plugin add kustomize                    https://github.com/Banno/asdf-kustomize.git
asdf plugin add minikube                     https://github.com/alvarobp/asdf-minikube.git
asdf plugin add nodejs                       https://github.com/asdf-vm/asdf-nodejs.git
asdf plugin add python                       https://github.com/asdf-community/asdf-python.git
asdf plugin add ruby                         https://github.com/asdf-vm/asdf-ruby.git
asdf plugin add sbt                          https://github.com/bram2000/asdf-sbt.git
asdf plugin add scala                        https://github.com/asdf-community/asdf-scala
asdf plugin add terraform                    https://github.com/asdf-community/asdf-hashicorp.git

for plugin in golang krew kubecolor kubectl kubectx kustomize nodejs python ruby; do
  asdf install "$plugin" latest
  asdf global "$plugin" latest
done

asdf reshim
